# GitLab AI Copilot ğŸ¤–

<div align="center">

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Node.js Version](https://img.shields.io/badge/node-%3E%3D16.0.0-brightgreen.svg)](https://nodejs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-4.9+-blue.svg)](https://www.typescriptlang.org/)
[![Docker](https://img.shields.io/badge/Docker-supported-blue.svg)](https://www.docker.com/)

**è®© AI æˆä¸ºä½ çš„ GitLab å¼€å‘ä¼™ä¼´**

*åœ¨ GitLab Issue å’Œ MR ä¸­ç›´æ¥ä½¿ç”¨ `@claude` / `@codex`,ä½“éªŒå‰æ‰€æœªæœ‰çš„æ™ºèƒ½å¼€å‘åä½œ*

[å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹) â€¢ [æ ¸å¿ƒç‰¹æ€§](#æ ¸å¿ƒç‰¹æ€§) â€¢ [å®é™…åº”ç”¨](#å®é™…åº”ç”¨) â€¢ [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—) â€¢ [åœ¨çº¿æ¼”ç¤º](#ä½¿ç”¨æŒ‡å—)

</div>

---

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

GitLab AI Copilot æ˜¯ä¸€ä¸ª**ä¼ä¸šçº§çš„ AI é©±åŠ¨å¼€å‘åä½œå¹³å°**,é€šè¿‡ GitLab Webhook å°†å¤šç§ AI ä»£ç åŠ©æ‰‹(Claudeã€Codex ç­‰)æ·±åº¦é›†æˆåˆ° GitLab å·¥ä½œæµä¸­ã€‚

### ğŸ’¡ ä¸ºä»€ä¹ˆé€‰æ‹© GitLab AI Copilot?

ä¼ ç»Ÿçš„ AI ä»£ç åŠ©æ‰‹é€šå¸¸éœ€è¦åœ¨ IDE ä¸­ä½¿ç”¨,ä¸å›¢é˜Ÿåä½œæµç¨‹è„±èŠ‚ã€‚GitLab AI Copilot åˆ›æ–°æ€§åœ°å°† AI èƒ½åŠ›**åŸç”Ÿé›†æˆåˆ° GitLab å¹³å°**,å®ç°:

- âœ… **é›¶ä¸Šä¸‹æ–‡åˆ‡æ¢**: ç›´æ¥åœ¨ Issue/MR ä¸­ä¸ AI å¯¹è¯,æ— éœ€ç¦»å¼€ GitLab
- âœ… **å›¢é˜Ÿå¯è§æ€§**: AI çš„å·¥ä½œè¿‡ç¨‹å’Œç»“æœå¯¹æ•´ä¸ªå›¢é˜Ÿé€æ˜å¯è¿½æº¯
- âœ… **è‡ªåŠ¨åŒ–å·¥ä½œæµ**: AI è‡ªåŠ¨åˆ›å»ºåˆ†æ”¯ã€æäº¤ä»£ç ã€ç”Ÿæˆ MR
- âœ… **æŒç»­å¯¹è¯èƒ½åŠ›**: AI è®°ä½ä¸Šä¸‹æ–‡,æ”¯æŒå¤šè½®äº¤äº’å¼å¼€å‘

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### 1ï¸âƒ£ **æ™ºèƒ½ Issue** - åŒæ¨¡å¼ Issue å¤„ç†ç³»ç»Ÿ

#### ğŸš€ ä»£ç å¼€å‘æ¨¡å¼ (`@claude` / `@codex` / é»˜è®¤)
```markdown
# åœ¨ GitLab Issue ä¸­ - å¤šç§æ–¹å¼è§¦å‘ä»£ç å¼€å‘
@claude ä¸ºè¿™ä¸ªé¡¹ç›®æ·»åŠ ç”¨æˆ·è®¤è¯åŠŸèƒ½,åŒ…æ‹¬ JWTã€å¯†ç åŠ å¯†å’Œæƒé™ä¸­é—´ä»¶
@codex ä¼˜åŒ–è¿™æ®µä»£ç çš„æ€§èƒ½
# æˆ–è€…ç›´æ¥å†™éœ€æ±‚ï¼Œé»˜è®¤ä½¿ç”¨ Claude
æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½ï¼Œæ”¯æŒé‚®ç®±å’Œæ‰‹æœºå·ç™»å½•

# AI è‡ªåŠ¨å®Œæˆ:
âœ… åˆ†æéœ€æ±‚å¹¶ç”Ÿæˆä»£ç 
âœ… åˆ›å»ºæ—¶é—´æˆ³åˆ†æ”¯ (claude-20240115-abc123)
âœ… æäº¤ä»£ç å¹¶æ¨é€
âœ… åˆ›å»ºç¬¦åˆçº¦å®šå¼æäº¤è§„èŒƒçš„ MR
âœ… åœ¨ Issue ä¸­å®æ—¶æ›´æ–°è¿›åº¦
```

#### ğŸ“‹ æ–‡æ¡£è§„èŒƒæ¨¡å¼ (`/spec` / `/plan` / `/tasks`)
```markdown
# åœ¨ GitLab Issue ä¸­ - æ–‡æ¡£é©±åŠ¨å¼€å‘
/spec ä¸ºç”¨æˆ·è®¤è¯åŠŸèƒ½ç¼–å†™å®Œæ•´çš„æŠ€æœ¯è§„èŒƒæ–‡æ¡£
/plan åˆ¶å®šç”¨æˆ·è®¤è¯åŠŸèƒ½çš„å®æ–½è®¡åˆ’
/tasks ç”Ÿæˆç”¨æˆ·è®¤è¯åŠŸèƒ½çš„å¼€å‘ä»»åŠ¡æ¸…å•

# æ³¨æ„ï¼šæ–‡æ¡£æ¨¡å¼å¼ºåˆ¶ä½¿ç”¨ Claudeï¼Œä¸æ”¯æŒ @codex
# AI è‡ªåŠ¨å®Œæˆ:
âœ… æ£€æŸ¥ Spec Kit åˆå§‹åŒ–çŠ¶æ€
âœ… è°ƒç”¨å¯¹åº”çš„ /speckit.* å‘½ä»¤ç”Ÿæˆæ–‡æ¡£
âœ… åˆ›å»ºæ—¶é—´æˆ³åˆ†æ”¯å¹¶æäº¤æ–‡æ¡£
âœ… åˆ›å»º MR ç”¨äºæ–‡æ¡£è¯„å®¡
âœ… åœ¨ Issue ä¸­å±•ç¤ºç”Ÿæˆçš„æ–‡æ¡£å†…å®¹
```

**åˆ›æ–°ç‚¹**:
- ğŸ¯ **åŒæ¨¡å¼æ”¯æŒ**: ä»£ç å¼€å‘ (`@claude`/`@codex`/é»˜è®¤) å’Œæ–‡æ¡£è§„èŒƒ (`/spec`/`/plan`/`/tasks`) æ¸…æ™°åˆ†ç¦»
- ğŸ¯ **AI é€‰æ‹©ç­–ç•¥**: æ–‡æ¡£æ¨¡å¼å¼ºåˆ¶ä½¿ç”¨ Claudeï¼Œä»£ç å¼€å‘æ¨¡å¼å¯è‡ªç”±é€‰æ‹© AI
- ğŸ”„ **é•¿äº¤äº’æ¨¡å¼**: åŒä¸€ä¸ª Issue ä¸­è¿ç»­å¯¹è¯,AI è®°ä½æ‰€æœ‰ä¸Šä¸‹æ–‡
- ğŸ“‹ **Spec Kit é›†æˆ**: è‡ªåŠ¨æ£€æµ‹å’Œåˆå§‹åŒ– Spec Kit å·¥å…·é“¾
- ğŸ“Š **æ–‡æ¡£ç®¡ç†**: è‡ªåŠ¨æ”¶é›†å’Œç®¡ç†è§„èŒƒæ–‡æ¡£,æ”¯æŒå¤šé˜¶æ®µæ–‡æ¡£å¼€å‘
- ğŸ“Š **å®æ—¶åé¦ˆ**: åœ¨ GitLab è¯„è®ºä¸­çœ‹åˆ° AI çš„å·¥ä½œè¿›åº¦å’Œç”Ÿæˆçš„æ–‡æ¡£
- ğŸ¯ **æ™ºèƒ½é»˜è®¤**: æ— å‰ç¼€æ—¶é»˜è®¤ä½¿ç”¨ Claude è¿›è¡Œä»£ç å¼€å‘ï¼Œé™ä½ä½¿ç”¨é—¨æ§›

### 2ï¸âƒ£ **é›¶é…ç½®ä»£ç å®¡æŸ¥** - AI è‡ªåŠ¨å®¡æŸ¥æ¯ä¸ª MR

```markdown
# åˆ›å»º MR æ—¶
æ ‡é¢˜: feat(api): add user profile endpoints

# ä¸éœ€è¦ä»»ä½•é¢å¤–æ“ä½œ,AI è‡ªåŠ¨:
âœ… æ£€æµ‹æ–° MR (ä½¿ç”¨ CODE_REVIEW_EXECUTOR é…ç½®çš„é»˜è®¤ AI,é»˜è®¤ä¸º Codex)
âœ… åˆ†æä»£ç å˜æ›´
âœ… æŒ‰æ–‡ä»¶/è¡Œå·æä¾›ç»“æ„åŒ–åé¦ˆ
âœ… æ ‡æ³¨å®‰å…¨é—®é¢˜ã€æ€§èƒ½å»ºè®®ã€æœ€ä½³å®è·µ
âœ… è‡ªåŠ¨ç”Ÿæˆ MR Summary (å˜æ›´æ¦‚è¦ã€å½±å“åˆ†æã€æµ‹è¯•å»ºè®®)
âœ… è‡ªåŠ¨ä¿®å¤ MR æ ‡é¢˜ (ç¬¦åˆçº¦å®šå¼æäº¤è§„èŒƒ: feat/fix/docs/refactor ç­‰)
```

**åˆ›æ–°ç‚¹**:
- ğŸ¤– **æ™ºèƒ½é»˜è®¤**: MR open/reopen æ—¶è‡ªåŠ¨è§¦å‘å®¡æŸ¥,å³ä½¿æ²¡æœ‰ @AI æåŠ
- ğŸ¨ **çµæ´»é€‰æ‹©**: å¯é€šè¿‡ `@claude` æˆ– `@codex` æŒ‡å®šå®¡æŸ¥è€…
- ğŸ“‹ **éµå¾ªè§„èŒƒ**: åŸºäº `CODE_REVIEW_GUIDELINES.md` çš„é¡¹ç›®å®šåˆ¶å®¡æŸ¥
- ğŸ“ **è‡ªåŠ¨ Summary**: AI è‡ªåŠ¨åˆ†æä»£ç å˜æ›´,ç”Ÿæˆç»“æ„åŒ–çš„ MR æ¦‚è¦è¯´æ˜
- ğŸ·ï¸ **æ ‡é¢˜è§„èŒƒåŒ–**: è‡ªåŠ¨æ£€æµ‹å¹¶ä¿®å¤ä¸è§„èŒƒçš„ MR æ ‡é¢˜,ç¡®ä¿ç¬¦åˆå›¢é˜Ÿè§„èŒƒ

### 3ï¸âƒ£ **MR å†…ç›´æ¥ä¿®å¤** - è¯„è®ºå³æŒ‡ä»¤,ä»£ç å³æ›´æ–°

```markdown
# åœ¨ MR è¯„è®ºä¸­
@claude æ ¹æ®å®¡æŸ¥æ„è§ä¿®å¤å®‰å…¨é—®é¢˜,å¹¶æ·»åŠ è¾“å…¥éªŒè¯

# AI è‡ªåŠ¨:
âœ… åœ¨ MR æºåˆ†æ”¯ä¸Šä¿®æ”¹ä»£ç 
âœ… æäº¤å¹¶æ¨é€æ›´æ”¹
âœ… MR è‡ªåŠ¨æ›´æ–°
âœ… æ— éœ€åˆ›å»ºæ–°åˆ†æ”¯æˆ–æ–° MR
```

**åˆ›æ–°ç‚¹**:
- ğŸ¯ **ç›´æ¥ä¿®æ”¹**: ä»£ç ç›´æ¥æäº¤åˆ° MR æºåˆ†æ”¯,è€Œéåˆ›å»ºæ–° MR
- ğŸ”„ **è‡ªåŠ¨åŒæ­¥**: æ¨é€å†²çªæ—¶è‡ªåŠ¨ rebase å¹¶å°è¯•è§£å†³å†²çª
- ğŸ’¬ **ä¸Šä¸‹æ–‡æ„ŸçŸ¥**: AI ç†è§£ MR çš„å®Œæ•´ä¸Šä¸‹æ–‡å’Œå†å²è®¨è®º

### 4ï¸âƒ£ **å¤š AI ååŒ** - ä¸€ä¸ªå¹³å°,å¤šç§ AI

```markdown
@claude é‡æ„è¿™ä¸ªæ¨¡å—,æé«˜å¯è¯»æ€§     # ä½¿ç”¨ Claude (æ“…é•¿ä»£ç è´¨é‡)
@codex ä¼˜åŒ–è¿™æ®µä»£ç çš„æ€§èƒ½          # ä½¿ç”¨ Codex (æ“…é•¿æ€§èƒ½ä¼˜åŒ–)
```

**åˆ›æ–°ç‚¹**:
- ğŸ”€ **ç‹¬ç«‹ä¼šè¯**: æ¯ä¸ª AI ç»´æŠ¤ç‹¬ç«‹çš„å¯¹è¯ä¸Šä¸‹æ–‡
- ğŸ¯ **æŒ‰éœ€åˆ‡æ¢**: æ ¹æ®ä»»åŠ¡ç‰¹ç‚¹é€‰æ‹©æœ€é€‚åˆçš„ AI
- ğŸ“Š **ç»Ÿä¸€ç®¡ç†**: æ‰€æœ‰ AI çš„å·¥ä½œå†å²éƒ½è®°å½•åœ¨ GitLab ä¸­

### 5ï¸âƒ£ **ä¼ä¸šçº§å¤šç§Ÿæˆ·** - æ”¯æŒç»„ç»‡çº§éƒ¨ç½²

```bash
# å¿«é€Ÿåˆ›å»ºç§Ÿæˆ·
npm run setup-user -- \
  --email team@company.com \
  --name "ç ”å‘å›¢é˜Ÿ" \
  --gitlab-url https://gitlab.company.com \
  --pat gitlab_token

# æ¯ä¸ªç§Ÿæˆ·ç‹¬ç«‹çš„ Webhook URL
https://your-domain.com/webhook/{userToken}
```

**åˆ›æ–°ç‚¹**:
- ğŸ¢ **æ•°æ®éš”ç¦»**: MongoDB + åŠ å¯†å­˜å‚¨,ç§Ÿæˆ·æ•°æ®å®Œå…¨éš”ç¦»
- ğŸ¨ **Web ç®¡ç†**: å¯è§†åŒ–é…ç½®ç•Œé¢,éæŠ€æœ¯äººå‘˜ä¹Ÿèƒ½æ“ä½œ
- ğŸ“Š **ä½¿ç”¨ç»Ÿè®¡**: æ¯ä¸ªç§Ÿæˆ·çš„ AI ä½¿ç”¨æƒ…å†µç‹¬ç«‹ç»Ÿè®¡

## ğŸ¨ å®é™…åº”ç”¨åœºæ™¯

### åœºæ™¯ 1: å¿«é€ŸåŸå‹å¼€å‘
```
äº§å“ç»ç†åœ¨ Issue ä¸­æè¿°éœ€æ±‚
  â†’ @claude å®ç°åŠŸèƒ½
  â†’ å¼€å‘è€… review MR
  â†’ åˆå¹¶ä¸Šçº¿
```
**èŠ‚çœæ—¶é—´**: ä»éœ€æ±‚åˆ°å¯è¿è¡Œä»£ç ,15 åˆ†é’Ÿå†…å®Œæˆ

### åœºæ™¯ 2: æ–‡æ¡£é©±åŠ¨å¼€å‘
```
äº§å“ç»ç†åœ¨ Issue ä¸­æè¿°åŠŸèƒ½éœ€æ±‚
  â†’ @spec ç”Ÿæˆå®Œæ•´æŠ€æœ¯è§„èŒƒ
  â†’ /plan ç”Ÿæˆå®æ–½è®¡åˆ’
  â†’ /tasks ç”Ÿæˆä»»åŠ¡æ¸…å•
  â†’ å›¢é˜Ÿè¯„å®¡å¹¶æ‰§è¡Œ
```
**æå‡è´¨é‡**: æ–‡æ¡£å…ˆè¡Œ,ç¡®ä¿éœ€æ±‚æ˜ç¡®å’Œå®æ–½è§„èŒƒ

### åœºæ™¯ 3: ä»£ç è´¨é‡ä¿éšœ
```
å¼€å‘è€…åˆ›å»º MR (æ ‡é¢˜å¯èƒ½ä¸è§„èŒƒ)
  â†’ AI è‡ªåŠ¨ä¿®å¤æ ‡é¢˜ä¸ºè§„èŒƒæ ¼å¼
  â†’ AI ç”Ÿæˆè¯¦ç»†çš„å˜æ›´ Summary
  â†’ AI è‡ªåŠ¨å®¡æŸ¥ä»£ç (é»˜è®¤ Codex)
  â†’ åœ¨è¯„è®ºä¸­ @claude ä¿®å¤é—®é¢˜
  â†’ ä»£ç è‡ªåŠ¨æ›´æ–°
  â†’ äººå·¥æœ€ç»ˆç¡®è®¤
```
**æå‡è´¨é‡**: æ¯ä¸ª MR éƒ½ç»è¿‡ AI å®¡æŸ¥ã€è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£ã€æ ‡é¢˜è§„èŒƒåŒ–,å…¨æ–¹ä½ä¿éšœä»£ç è´¨é‡

### åœºæ™¯ 4: æŠ€æœ¯å€ºåŠ¡æ¸…ç†
```
åœ¨ Issue ä¸­åˆ›å»ºé‡æ„ä»»åŠ¡
  â†’ @claude é‡æ„æ¨¡å— A
  â†’ ç»§ç»­å¯¹è¯: ç°åœ¨æ·»åŠ å•å…ƒæµ‹è¯•
  â†’ ç»§ç»­å¯¹è¯: æ›´æ–°æ–‡æ¡£
  â†’ ä¸€æ¬¡æ€§äº§å‡ºå®Œæ•´çš„é‡æ„ MR
```
**ä¿æŒä¸Šä¸‹æ–‡**: å¤šè½®å¯¹è¯é€æ­¥å®Œå–„,AI è®°ä½æ‰€æœ‰ç»†èŠ‚

## ğŸ”¥ æŠ€æœ¯äº®ç‚¹

| ç‰¹æ€§ | ä¼ ç»Ÿæ–¹æ¡ˆ | GitLab AI Copilot |
|------|----------|-------------------|
| **AI ä½¿ç”¨æ–¹å¼** | åœ¨ IDE ä¸­å•ç‹¬ä½¿ç”¨ | åŸç”Ÿé›†æˆåœ¨ GitLab å·¥ä½œæµ |
| **å›¢é˜Ÿåä½œ** | ä¸ªäººå·¥å…·,å›¢é˜Ÿä¸å¯è§ | æ‰€æœ‰è¿‡ç¨‹åœ¨ GitLab ä¸­å¯è¿½æº¯ |
| **ä¸Šä¸‹æ–‡è®°å¿†** | æ¯æ¬¡å¯¹è¯ç‹¬ç«‹ | é•¿äº¤äº’æ¨¡å¼,è®°ä½å®Œæ•´ä¸Šä¸‹æ–‡ |
| **ä»£ç å®¡æŸ¥** | æ‰‹åŠ¨è§¦å‘æˆ–å•ç‹¬å·¥å…· | è‡ªåŠ¨è§¦å‘,é›¶é…ç½® |
| **MR æ›´æ–°** | éœ€è¦æ‰‹åŠ¨æ“ä½œ | è¯„è®ºå³å¯è§¦å‘ä»£ç ä¿®æ”¹ |
| **å¤šç§Ÿæˆ·** | ä¸æ”¯æŒ | ä¼ä¸šçº§å¤šç§Ÿæˆ· + Web ç®¡ç† |
| **å·¥ä½œåŒºç®¡ç†** | æ— çŠ¶æ€ | æ™ºèƒ½å·¥ä½œåŒºå¤ç”¨,èŠ‚çœèµ„æº |

## ğŸ“Š æ¶æ„ä¼˜åŠ¿

- **ğŸ“¦ æ¨¡å—åŒ–è®¾è®¡**: Session Managerã€Workspace Managerã€AI Executor è§£è€¦
- **ğŸ”„ æ™ºèƒ½èµ„æºç®¡ç†**: å·¥ä½œåŒºå’Œä¼šè¯è‡ªåŠ¨æ¸…ç†,é¿å…èµ„æºæµªè´¹
- **âš¡ æµå¼è¿›åº¦æ›´æ–°**: å®æ—¶åé¦ˆ AI å·¥ä½œçŠ¶æ€,ä½“éªŒæµç•…
- **ğŸ›¡ï¸ å®‰å…¨å¯é **: Webhook ç­¾åéªŒè¯ã€æ•æ„Ÿä¿¡æ¯åŠ å¯†ã€Git æ“ä½œå®‰å…¨éš”ç¦»
- **ğŸ¯ é«˜åº¦å¯é…ç½®**: æ”¯æŒè‡ªå®šä¹‰å®¡æŸ¥è§„èŒƒã€AI é€‰æ‹©ã€ä¼šè¯ç­–ç•¥

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [æ ¸å¿ƒç‰¹æ€§](#æ ¸å¿ƒç‰¹æ€§)
- [å®é™…åº”ç”¨åœºæ™¯](#å®é™…åº”ç”¨åœºæ™¯)
- [æŠ€æœ¯äº®ç‚¹](#æŠ€æœ¯äº®ç‚¹)
- [æ¶æ„ä¼˜åŠ¿](#æ¶æ„ä¼˜åŠ¿)
- [è¯¦ç»†åŠŸèƒ½è¯´æ˜](#è¯¦ç»†åŠŸèƒ½è¯´æ˜)
- [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
- [å·¥ä½œåŒºä¸ä¼šè¯ç®¡ç†](#å·¥ä½œåŒºä¸ä¼šè¯ç®¡ç†)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
- [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)
- [ä½¿ç”¨æŒ‡å—](#ä½¿ç”¨æŒ‡å—)
- [Web ç®¡ç†ç•Œé¢](#web-ç®¡ç†ç•Œé¢)
- [API æ–‡æ¡£](#api-æ–‡æ¡£)
- [ç›‘æ§å’Œç®¡ç†](#ç›‘æ§å’Œç®¡ç†)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
- [æ›´æ–°æ—¥å¿—](#æ›´æ–°æ—¥å¿—)
- [è´¡çŒ®æŒ‡å—](#è´¡çŒ®æŒ‡å—)
- [è®¸å¯è¯](#è®¸å¯è¯)

---

## âœ¨ è¯¦ç»†åŠŸèƒ½è¯´æ˜

æœ¬ç« èŠ‚æä¾›é¡¹ç›®åŠŸèƒ½çš„è¯¦ç»†æŠ€æœ¯è¯´æ˜ã€‚å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡äº†è§£æœ¬é¡¹ç›®,å»ºè®®å…ˆé˜…è¯»ä¸Šé¢çš„[æ ¸å¿ƒç‰¹æ€§](#æ ¸å¿ƒç‰¹æ€§)ç« èŠ‚ã€‚

### ğŸ¤– AI é›†æˆèƒ½åŠ›

- **å¤š AI æ¨¡å‹æ”¯æŒ**: æ”¯æŒ Claudeã€Codex ç­‰å¤šç§ AI æ¨¡å‹,å¯æ ¹æ®ä»»åŠ¡ç‰¹ç‚¹é€‰æ‹©æœ€åˆé€‚çš„ AI
- **æ™ºèƒ½æŒ‡ä»¤è¯†åˆ«**: é€šè¿‡ `@claude`ã€`@codex` æˆ– `@ai` æŒ‡ä»¤è°ƒç”¨,è‡ªç„¶è¯­è¨€äº¤äº’
- **ä¸Šä¸‹æ–‡æ„ŸçŸ¥**: AI è‡ªåŠ¨ç†è§£é¡¹ç›®ç»“æ„ã€ä»£ç ä¸Šä¸‹æ–‡å’Œ GitLab è®¨è®ºå†å²
- **é›¶é…ç½®å¯åŠ¨**: MR æ‰“å¼€æ—¶è‡ªåŠ¨è§¦å‘å®¡æŸ¥,æ— éœ€é¢å¤–é…ç½®

### ğŸ”„ è‡ªåŠ¨åŒ–å·¥ä½œæµ

- **è‡ªåŠ¨åˆ†æ”¯ç®¡ç†**: AI ç”Ÿæˆçš„ä»£ç å˜æ›´è‡ªåŠ¨åˆ›å»ºæ—¶é—´æˆ³åˆ†æ”¯å¹¶æ¨é€
- **æ™ºèƒ½ MR ç”Ÿæˆ**: è‡ªåŠ¨ç”Ÿæˆç¬¦åˆçº¦å®šå¼æäº¤è§„èŒƒçš„æ ‡é¢˜(feat/fix/docs ç­‰)å’Œç»“æ„åŒ–æè¿°
- **ä»£ç å®¡æŸ¥**: æ–°å»ºæˆ–é‡æ–°æ‰“å¼€ MR æ—¶è‡ªåŠ¨è§¦å‘ä»£ç å®¡æŸ¥,é»˜è®¤ä½¿ç”¨ Codex
- **MR å†…ä¿®å¤**: åœ¨ MR è¯„è®ºä¸­ç›´æ¥æŒ‡ç¤º AI ä¿®æ”¹ä»£ç ,æ— éœ€åˆ›å»ºæ–°åˆ†æ”¯

### ğŸ’¬ é•¿äº¤äº’ä¸ä¼šè¯ç®¡ç†

- **ä¼šè¯è®°å¿†**: åœ¨åŒä¸€ä¸ª Issue/MR ä¸­è¿›è¡Œè¿ç»­çš„ AI å¯¹è¯,ä¿æŒå®Œæ•´ä¸Šä¸‹æ–‡è®°å¿†
- **å¤š Provider ä¼šè¯**: æ¯ä¸ª AI (Claude/Codex) ç»´æŠ¤ç‹¬ç«‹çš„ä¼šè¯ä¸Šä¸‹æ–‡,å¯çµæ´»åˆ‡æ¢
- **æ™ºèƒ½ Session ç®¡ç†**: è‡ªåŠ¨ç®¡ç†ä¼šè¯ç”Ÿå‘½å‘¨æœŸ,æ”¯æŒé…ç½®åŒ–çš„æ¸…ç†ç­–ç•¥
- **å®æ—¶è¿›åº¦åé¦ˆ**: åœ¨ GitLab è¯„è®ºä¸­å®æ—¶æŸ¥çœ‹ AI å¤„ç†è¿›åº¦å’ŒçŠ¶æ€
- **å·¥ä½œåŒºå¤ç”¨**: åŒä¸€ Issue/MR å†…å¤šæ¬¡æ“ä½œå…±äº«å·¥ä½œåŒº,æé«˜æ•ˆç‡

### ğŸ¢ ä¼ä¸šçº§ç‰¹æ€§

- **å¤šç§Ÿæˆ·æ¶æ„**: æ”¯æŒå¤šç”¨æˆ·/å¤šç»„ç»‡çš„ç‹¬ç«‹é…ç½®,æ•°æ®å®Œå…¨éš”ç¦»
- **å®‰å…¨åŠ å¯†**: æ•æ„Ÿä¿¡æ¯(GitLab Token ç­‰)ä½¿ç”¨ AES-256 åŠ å¯†å­˜å‚¨
- **Web ç®¡ç†ç•Œé¢**: æä¾›ç›´è§‚çš„ Web UI è¿›è¡Œé…ç½®ç®¡ç†å’Œä½¿ç”¨ç»Ÿè®¡æŸ¥çœ‹
- **Docker æ”¯æŒ**: å®Œæ•´çš„å®¹å™¨åŒ–éƒ¨ç½²æ–¹æ¡ˆ,æ”¯æŒ Docker Compose å’Œ Kubernetes
- **æƒé™æ§åˆ¶**: Webhook ç­¾åéªŒè¯,ç¡®ä¿è¯·æ±‚æ¥æºå¯ä¿¡

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```mermaid
graph TB
    A[GitLab Webhook] --> B[Webhook Server]
    B --> C[Event Processor]
    C --> D{Session Mode?}
    D -->|Yes| E[Session Manager]
    D -->|No| F[Project Manager]
    E --> G[Streaming AI Executor]
    F --> G
    G --> H[AI CLI Tools]
    H --> I[Code Generation]
    I --> J[MR Generator]
    J --> K[GitLab API]
    K --> L[GitLab Repository]
```

### æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | èŒè´£ | æ–‡ä»¶ä½ç½® |
|------|------|----------|
| **Webhook Server** | æ¥æ”¶ GitLab webhook äº‹ä»¶ | `src/server/webhookServer.ts` |
| **Event Processor** | ä¸­å¤®åè°ƒå™¨ï¼Œç®¡ç†å·¥ä½œæµç¨‹ | `src/services/eventProcessor.ts` |
| **Session Manager** | ç®¡ç†é•¿äº¤äº’ä¼šè¯å’Œä¸Šä¸‹æ–‡ | `src/services/sessionManager.ts` |
| **AI Executor** | æ‰§è¡Œ AI CLI å·¥å…·ï¼Œæä¾›æµå¼æ›´æ–° | `src/services/streamingAiExecutor.ts` |
| **Project Manager** | å¤„ç† Git æ“ä½œå’Œåˆ†æ”¯ç®¡ç† | `src/services/projectManager.ts` |
| **GitLab Service** | GitLab API äº¤äº’ | `src/services/gitlabService.ts` |

## ğŸ§  å·¥ä½œåŒºä¸ä¼šè¯ç®¡ç†

ä¸ºäº†åŒæ—¶å…¼é¡¾ä»£ç çŠ¶æ€å¤ç”¨å’Œ AI å¯¹è¯è®°å¿†ï¼Œç³»ç»Ÿå¯¹ä¸åŒåœºæ™¯é‡‡ç”¨å·®å¼‚åŒ–çš„å·¥ä½œåŒºä¸ Session ç­–ç•¥ï¼š

### å·¥ä½œåŒºï¼ˆWorkspaceï¼‰å¤ç”¨

| åœºæ™¯ | å·¥ä½œåŒº ID | è¡Œä¸º | è¯´æ˜ |
|------|-----------|------|------|
| Issue é•¿å¯¹è¯ | `sessionKey = projectId:issueIid[:ownerId]` | å§‹ç»ˆå¤ç”¨ | ç”± `SessionManager` ç”Ÿæˆï¼Œè·¨å¤šè½®æŒ‡ä»¤å…±äº«ä»£ç çŠ¶æ€ |
| Merge Request å…¨æµç¨‹ | `mr:<projectId>:<mrIid>` | å§‹ç»ˆå¤ç”¨ | MR è¯„è®ºä¿®å¤ã€è‡ªåŠ¨å®¡æŸ¥ç­‰æ‰€æœ‰ MR äº‹ä»¶éƒ½å…±äº«åŒä¸€ç›®å½• |
| ç‰¹æ®Šä¸€æ¬¡æ€§ä»»åŠ¡ï¼ˆæ˜¾å¼ç¦ç”¨ä¼šè¯æ—¶ï¼‰ | éšæœº UUID | æ‰§è¡Œåæ¸…ç† | ä»…åœ¨å…³é—­ session æˆ–è‡ªå®šä¹‰æŒ‡ä»¤æ—¶è§¦å‘çš„ fallback |

- `ProjectManager.prepareProject` ä¼šæ ¹æ® `workspaceId` è‡ªåŠ¨å†³å®šæ˜¯é‡ç”¨è¿˜æ˜¯æ–°å»ºç›®å½•ï¼Œå¹¶å°†ä½¿ç”¨æƒ…å†µå†™å…¥ MongoDB çš„ `workspaces` é›†åˆã€‚
- `WorkspaceCleanupService` ä¾èµ–æŒä¹…åŒ–çš„å…ƒæ•°æ®ï¼ˆç¼ºçœå›é€€åˆ°æ–‡ä»¶ç³»ç»Ÿæ—¶é—´æˆ³ï¼‰ï¼Œç»“åˆ `WORKSPACE_MAX_IDLE_TIME` ä¸ `WORKSPACE_CLEANUP_INTERVAL` å®šæœŸæ¸…ç†ä¹…æœªä½¿ç”¨çš„å·¥ä½œåŒºã€‚

### AI Session å¤ç”¨

| åœºæ™¯ | æ‰§è¡Œå™¨ | Session ID | å¤‡æ³¨ |
|------|--------|------------|------|
| Issue å¯¹è¯ | `executeWithSession` | ç”± `SessionManager` æŒä¹…åŒ– | æ”¯æŒè‡ªç„¶å¤šè½®å¯¹è¯ï¼Œæ”¯æŒå¤š provider (codex/claude) |
| MR è¯„è®º | `executeWithSession` | åŒä¸€ MR/è®¨è®ºå…±äº« | è®°ä½ä¸Šä¸€è½® MR æŒ‡ä»¤å†å²ï¼Œæ”¯æŒå¤š provider |
| MR ä»£ç å®¡æŸ¥ | `executeWithSession` | ç”± `SessionManager` æŒä¹…åŒ– | æ”¯æŒå¤šè½®å®¡æŸ¥å¯¹è¯ï¼Œä¿ç•™å®¡æŸ¥ä¸Šä¸‹æ–‡ï¼Œæ”¯æŒå¤š provider |
| ç‰¹æ®Šä¸€æ¬¡æ€§ä»»åŠ¡ | `executeWithStreaming` | ä¸å¤ç”¨ | ä»…åœ¨æ˜¾å¼ç¦ç”¨ session æ—¶ä½¿ç”¨ |

- Session å…ƒæ•°æ®åŒ…å« `branch/baseBranch`ã€`discussionId`ã€`mergeRequestUrl` ç­‰ä¿¡æ¯ï¼Œä¾¿äºåç»­æ“ä½œã€‚
- å½“ AI è¿”å› session å¤±æ•ˆé”™è¯¯æ—¶ï¼Œä¼šè‡ªåŠ¨æ¸…ç†æ—§ session å¹¶é‡è¯•åˆ›å»ºæ–°ä¼šè¯ã€‚
- ä¼šè¯è®°å½•æŒ‰ provider åˆ†æ¡¶ï¼š`SessionManager` ä¼šå°†ä¸åŒåŠ©æ‰‹çš„ `sessionId` ä¿å­˜åœ¨ `providerSessions` å­—æ®µä¸­ï¼Œ`lastProvider` æ ‡è®°æœ€è¿‘ä¸€æ¬¡è¢«å‘½ä¸­çš„åŠ©æ‰‹ã€‚åˆ‡æ¢ `@claude` / `@codex` æ—¶ï¼Œå„è‡ªç»´æŒç‹¬ç«‹ä¸Šä¸‹æ–‡äº’ä¸å¹²æ‰°ã€‚

> ğŸ”§ ç¯å¢ƒå˜é‡  
> - `WORKSPACE_MAX_IDLE_TIME` (é»˜è®¤ 24h)  
> - `WORKSPACE_CLEANUP_INTERVAL` (é»˜è®¤ 6h)  
> - `SESSION_*` é…ç½®é¡¹è¯¦è§ä¸‹æ–‡ç¯å¢ƒé…ç½®ç« èŠ‚ã€‚é»˜è®¤ä½¿ç”¨ä¸‹ï¼Œæ— éœ€é¢å¤–å¯ç”¨å³å¯åœ¨ Issue ä¸ MR ä¸­è·å¾—å·¥ä½œåŒºå’Œä¼šè¯å¤ç”¨ã€‚
> âš ï¸ Node.js å®šæ—¶å™¨æœ€å¤§å»¶è¿Ÿçº¦ä¸º `2^31 - 1` æ¯«ç§’ï¼ˆçº¦ 24.8 å¤©ï¼‰ï¼Œè¯·å°† `WORKSPACE_CLEANUP_INTERVAL` ä¸ `SESSION_CLEANUP_INTERVAL` è®¾ç½®åœ¨æ­¤é˜ˆå€¼ä»¥å†…ä»¥é¿å…æº¢å‡ºè­¦å‘Šã€‚

#### Session å­˜å‚¨ç»“æ„

`SESSION_STORE_PATH`ï¼ˆé»˜è®¤ `/tmp/gitlab-copilot-work/sessions.json`ï¼‰ä¸­çš„è®°å½•ç¤ºä¾‹ï¼š

```json
{
  "issueKey": "68db9d070f0803ac372e00e6:3678:21",
  "projectId": 3678,
  "issueIid": 21,
  "createdAt": "2025-01-09T13:17:47.715Z",
  "lastUsed": "2025-01-09T13:18:58.525Z",
  "lastProvider": "codex",
  "providerSessions": {
    "claude": {
      "sessionId": "0199c90d-acd5-79b1-810b-c692d0e83cf8",
      "lastUsed": "2025-01-09T12:59:10.410Z"
    },
    "codex": {
      "sessionId": "0199c91e-e548-79c3-9f82-f2d7a70e9db4",
      "lastUsed": "2025-01-09T13:18:58.525Z"
    }
  },
  "baseBranch": "main",
  "branchName": "feature/awesome-update",
  "mergeRequestIid": 21,
  "mergeRequestUrl": "https://gitlab.example.com/group/project/-/merge_requests/21",
  "ownerId": "68db9d070f0803ac372e00e6"
}
```

> å…¼å®¹æç¤ºï¼šæ—§ç‰ˆæœ¬é—ç•™çš„å• `sessionId` è®°å½•ä¼šåœ¨ä¸‹æ¬¡æˆåŠŸå†™å…¥æ—¶è‡ªåŠ¨è¿ç§»ï¼›å¦‚éœ€ç«‹å³ä½¿ç”¨æ–°ç»“æ„ï¼Œå¯å…ˆå¤‡ä»½ååˆ é™¤æ—§çš„ `sessions.json` æ–‡ä»¶ï¼Œå†è§¦å‘ä¸€æ¬¡ AI æŒ‡ä»¤ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js >= 16.0.0
- npm æˆ– yarn
- Git
- MongoDB (å¤šç§Ÿæˆ·æ¨¡å¼)
- AI CLI å·¥å…· (Claude Code CLI æˆ– Codex CLI)

### 5 åˆ†é’Ÿå¿«é€Ÿéƒ¨ç½²

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone <repository-url>
   cd gitlab-copilot
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   npm install
   ```

3. **é…ç½®ç¯å¢ƒ**
   ```bash
   cp .env.example .env
   # ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®å¿…è¦çš„ç¯å¢ƒå˜é‡
   ```

4. **å®‰è£… AI CLI å·¥å…·**
   ```bash
   # Claude
   npm install -g @anthropic-ai/claude-code
   
   # ç™»å½• Claude (å¦‚æœéœ€è¦)
   claude login
   ```

5. **å¯åŠ¨æœåŠ¡**
   ```bash
   npm run dev
   ```

6. **é…ç½® GitLab Webhook**
   - URL: `https://your-domain.com/webhook`
   - Secret: ä½¿ç”¨ `.env` ä¸­çš„ `WEBHOOK_SECRET`
   - äº‹ä»¶: Issues, Merge Requests, Comments

## âš™ï¸ ç¯å¢ƒé…ç½®

### åŸºç¡€é…ç½®

```bash
# GitLab é…ç½®
GITLAB_BASE_URL=https://gitlab.com
GITLAB_TOKEN=your_gitlab_token
WEBHOOK_SECRET=your_webhook_secret

# AI é…ç½®
AI_EXECUTOR=claude
ANTHROPIC_AUTH_TOKEN=your_anthropic_token

# æœåŠ¡é…ç½®
PORT=3000
WORK_DIR=/tmp/gitlab-copilot-work
LOG_LEVEL=info
```

### å¤šç§Ÿæˆ·æ¨¡å¼é…ç½®

```bash
# MongoDB é…ç½®
MONGODB_URI=mongodb://user:pass@host:20000/?authSource=admin
MONGODB_DB=gitlab-copilot
ENCRYPTION_KEY=your_32_byte_encryption_key

# Web UI é…ç½®
WEB_UI_ENABLED=true
WEB_UI_BASE_PATH=/auth
JWT_SECRET=your_jwt_secret
CORS_ORIGINS=http://localhost:3000,https://your-domain.com

# å®‰å…¨é…ç½®
COOKIE_SECURE=true
COOKIE_SAME_SITE=strict
TRUST_PROXY=true
```

### Session ç®¡ç†é…ç½®

```bash
# Session é…ç½®
SESSION_ENABLED=true
SESSION_MAX_IDLE_TIME=7d
SESSION_MAX_SESSIONS=1000
SESSION_CLEANUP_INTERVAL=1h
SESSION_STORE_PATH=/tmp/gitlab-copilot-work/sessions.json
```

<details>
<summary>ğŸ“– æŸ¥çœ‹å®Œæ•´é…ç½®é€‰é¡¹</summary>

| ç¯å¢ƒå˜é‡ | é»˜è®¤å€¼ | æè¿° |
|----------|--------|------|
| `GITLAB_BASE_URL` | `https://gitlab.com` | GitLab å®ä¾‹ URL |
| `GITLAB_TOKEN` | - | GitLab API ä»¤ç‰Œ |
| `WEBHOOK_SECRET` | - | Webhook éªŒè¯å¯†é’¥ |
| `AI_EXECUTOR` | `claude` | é»˜è®¤ AI æ‰§è¡Œå™¨ |
| `CODE_REVIEW_EXECUTOR` | `codex` | ä»£ç å®¡æŸ¥é»˜è®¤ AI æ‰§è¡Œå™¨ |
| `ANTHROPIC_AUTH_TOKEN` | - | Anthropic API ä»¤ç‰Œ |
| `ANTHROPIC_BASE_URL` | `https://api.anthropic.com` | Anthropic API åŸºç¡€ URL |
| `PORT` | `3000` | æœåŠ¡ç«¯å£ |
| `WORK_DIR` | `/tmp/gitlab-copilot-work` | å·¥ä½œç›®å½• |
| `LOG_LEVEL` | `info` | æ—¥å¿—çº§åˆ« |
| `MONGODB_URI` | - | MongoDB è¿æ¥å­—ç¬¦ä¸² |
| `MONGODB_DB` | - | MongoDB æ•°æ®åº“å |
| `ENCRYPTION_KEY` | - | åŠ å¯†å¯†é’¥ (32 å­—èŠ‚) |

</details>

## ğŸ³ éƒ¨ç½²æŒ‡å—

### Docker éƒ¨ç½²

1. **ä½¿ç”¨ Docker Compose**
   ```bash
   docker-compose up -d
   ```

2. **æŸ¥çœ‹æ—¥å¿—**
   ```bash
   docker-compose logs -f gitlab-copilot
   ```

3. **åœæ­¢æœåŠ¡**
   ```bash
   docker-compose down
   ```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

1. **æ„å»ºé¡¹ç›®**
   ```bash
   npm run build
   ```

2. **å¯åŠ¨æœåŠ¡**
   ```bash
   npm run start
   ```

3. **ä½¿ç”¨ PM2 (æ¨è)**
   ```bash
   npm install -g pm2
   pm2 start ecosystem.config.js
   pm2 save
   pm2 startup
   ```

### Kubernetes éƒ¨ç½²

<details>
<summary>æŸ¥çœ‹ Kubernetes é…ç½®ç¤ºä¾‹</summary>

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: gitlab-copilot
spec:
  replicas: 2
  selector:
    matchLabels:
      app: gitlab-copilot
  template:
    metadata:
      labels:
        app: gitlab-copilot
    spec:
      containers:
      - name: gitlab-copilot
        image: gitlab-copilot:latest
        ports:
        - containerPort: 3000
        env:
        - name: MONGODB_URI
          valueFrom:
            secretKeyRef:
              name: gitlab-copilot-secrets
              key: mongodb-uri
        - name: ENCRYPTION_KEY
          valueFrom:
            secretKeyRef:
              name: gitlab-copilot-secrets
              key: encryption-key
---
apiVersion: v1
kind: Service
metadata:
  name: gitlab-copilot-service
spec:
  selector:
    app: gitlab-copilot
  ports:
  - port: 80
    targetPort: 3000
  type: LoadBalancer
```

</details>

## ğŸ“– ä½¿ç”¨æŒ‡å—

### æ”¯æŒçš„ AI æŒ‡ä»¤

| æŒ‡ä»¤ | æè¿° | ç¤ºä¾‹ |
|------|------|------|
| `@claude` | ä½¿ç”¨ Claude AI æ¨¡å‹ | `@claude é‡æ„è¿™ä¸ªç»„ä»¶` |
| `@codex` | ä½¿ç”¨ Codex AI æ¨¡å‹ | `@codex æ·»åŠ é”™è¯¯å¤„ç†` |
| `@ai` | ä½¿ç”¨é»˜è®¤ AI æ¨¡å‹ | `@ai ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢` |

### ğŸ“ Issue ä½¿ç”¨æµç¨‹

åœ¨ GitLab Issue ä¸­ä½¿ç”¨ AI åŠ©æ‰‹å¼€å‘æ–°åŠŸèƒ½æˆ–ä¿®å¤é—®é¢˜ã€‚æ”¯æŒé•¿äº¤äº’æ¨¡å¼,AI ä¼šè®°ä½ä¸Šä¸‹æ–‡ã€‚

#### åŸºæœ¬æµç¨‹

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant I as GitLab Issue
    participant S as Copilot æœåŠ¡
    participant A as AI æ‰§è¡Œå™¨
    participant G as Git ä»“åº“

    U->>I: åˆ›å»º Issue å¹¶ @claude
    I->>S: è§¦å‘ Webhook
    S->>S: æ£€æµ‹ Session æ¨¡å¼
    S->>A: æ‰§è¡Œ AI æŒ‡ä»¤
    A->>G: åˆ›å»ºæ—¶é—´æˆ³åˆ†æ”¯
    A->>G: ç”Ÿæˆä»£ç å¹¶æäº¤
    G->>I: åˆ›å»º MR
    A->>I: æ›´æ–°å®æ—¶è¿›åº¦
    I->>U: é€šçŸ¥å®Œæˆ
```

#### å®Œæ•´ç¤ºä¾‹

**1. åˆ›å»º Issue å¹¶å‘èµ· AI è¯·æ±‚**

```markdown
æ ‡é¢˜: æ·»åŠ ç”¨æˆ·è®¤è¯åŠŸèƒ½

æè¿°:
@claude è¯·ä¸ºè¿™ä¸ªé¡¹ç›®æ·»åŠ ç”¨æˆ·è®¤è¯åŠŸèƒ½,åŒ…æ‹¬:
- ç™»å½•å’Œæ³¨å†Œæ¥å£
- JWT token ç”Ÿæˆå’ŒéªŒè¯
- å¯†ç åŠ å¯†å­˜å‚¨
- åŸºæœ¬çš„æƒé™éªŒè¯ä¸­é—´ä»¶
```

**2. AI å¤„ç†æµç¨‹**

- âœ… æœåŠ¡æ¥æ”¶åˆ° webhook äº‹ä»¶
- âœ… è¯†åˆ« `@claude` æŒ‡ä»¤å¹¶æå–å®Œæ•´ä¸Šä¸‹æ–‡
- âœ… åˆ›å»ºæˆ–æ¢å¤ Session (é•¿äº¤äº’æ¨¡å¼)
- âœ… å…‹éš†ä»“åº“åˆ°å·¥ä½œç›®å½•
- âœ… åˆ›å»ºæ—¶é—´æˆ³åˆ†æ”¯: `claude-20240115T103045-abc123`
- âœ… AI æ‰§è¡Œä»£ç ç”Ÿæˆ
- âœ… è‡ªåŠ¨æäº¤æ›´æ”¹
- âœ… æ¨é€åˆ°è¿œç¨‹ä»“åº“
- âœ… åˆ›å»ºæ™ºèƒ½ MR (ç¬¦åˆçº¦å®šå¼æäº¤è§„èŒƒ)
- âœ… åœ¨ Issue ä¸­æ›´æ–°å®æ—¶è¿›åº¦

**3. ç”Ÿæˆçš„ MR ç¤ºä¾‹**

```
æ ‡é¢˜: feat(auth): add user authentication system

æè¿°:
## ğŸ“ å˜æ›´æ¦‚è¿°

æœ¬æ¬¡æäº¤æ·»åŠ å®Œæ•´çš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿ,åŒ…æ‹¬ç™»å½•ã€æ³¨å†Œã€token ç®¡ç†å’Œæƒé™éªŒè¯ã€‚

## ğŸ¯ è§£å†³çš„é—®é¢˜

- å®ç°ç”¨æˆ·ç™»å½•å’Œæ³¨å†Œæ¥å£
- JWT token ç”Ÿæˆå’ŒéªŒè¯æœºåˆ¶
- å¯†ç åŠ å¯†å­˜å‚¨ (bcrypt)
- æƒé™éªŒè¯ä¸­é—´ä»¶

## ğŸ“ å˜æ›´çš„æ–‡ä»¶

**æ–°å¢æ–‡ä»¶:**
- `src/auth/authController.ts` - è®¤è¯æ§åˆ¶å™¨
- `src/auth/authService.ts` - è®¤è¯æœåŠ¡
- `src/middleware/authMiddleware.ts` - æƒé™éªŒè¯ä¸­é—´ä»¶
- `src/utils/jwt.ts` - JWT å·¥å…·å‡½æ•°

**ä¿®æ”¹æ–‡ä»¶:**
- `src/server.ts` - æ·»åŠ è®¤è¯è·¯ç”±
- `package.json` - æ·»åŠ ç›¸å…³ä¾èµ–

## âœ… æµ‹è¯•æ¸…å•

- [ ] ç™»å½•åŠŸèƒ½æµ‹è¯• (æ­£ç¡®å’Œé”™è¯¯çš„å‡­æ®)
- [ ] æ³¨å†ŒåŠŸèƒ½æµ‹è¯• (æ•°æ®éªŒè¯)
- [ ] Token éªŒè¯æµ‹è¯•
- [ ] æƒé™ä¸­é—´ä»¶æµ‹è¯•
- [ ] å¯†ç åŠ å¯†æµ‹è¯•

## ğŸ¤– AI ç”Ÿæˆ

æœ¬ MR ç”± GitLab AI Copilot è‡ªåŠ¨ç”Ÿæˆ

ç›¸å…³ Issue: #123
```

**4. é•¿äº¤äº’æ¨¡å¼ - è¿ç»­å¯¹è¯**

åœ¨åŒä¸€ä¸ª Issue ä¸­ç»§ç»­å¯¹è¯,AI ä¼šè®°ä½ä¹‹å‰çš„ä¸Šä¸‹æ–‡:

```markdown
# ç¬¬ä¸€æ¬¡äº¤äº’
@claude è¯·åˆ›å»ºä¸€ä¸ªç”¨æˆ·ç®¡ç†ç³»ç»Ÿ

# ç­‰å¾… AI å®Œæˆå...

# ç¬¬äºŒæ¬¡äº¤äº’ (AI ä¼šè®°ä½ç¬¬ä¸€æ¬¡çš„ä»£ç )
ç°åœ¨è¯·æ·»åŠ é‚®ç®±éªŒè¯åŠŸèƒ½

# ç¬¬ä¸‰æ¬¡äº¤äº’
è¯·ä¸ºåˆšæ‰çš„ä»£ç æ·»åŠ å•å…ƒæµ‹è¯•

# ç¬¬å››æ¬¡äº¤äº’
ä¼˜åŒ–ä¸€ä¸‹æ€§èƒ½,æ·»åŠ ç¼“å­˜
```

**5. Issue ä¸­çš„è¿›åº¦æ›´æ–°**

AI ä¼šåœ¨ Issue ä¸­å®æ—¶æ›´æ–°å¤„ç†è¿›åº¦:

```markdown
ğŸ¤– AI å¤„ç†è¿›åº¦:

âœ… å…‹éš†ä»“åº“å®Œæˆ
âœ… åˆ›å»ºåˆ†æ”¯: claude-20240115T103045-abc123
â³ æ­£åœ¨ç”Ÿæˆä»£ç ...
âœ… ä»£ç ç”Ÿæˆå®Œæˆ
âœ… æäº¤æ›´æ”¹
âœ… æ¨é€åˆ°è¿œç¨‹ä»“åº“
âœ… åˆ›å»ºåˆå¹¶è¯·æ±‚: !456

ğŸ‰ å¤„ç†å®Œæˆï¼è¯·æŸ¥çœ‹ MR !456
```

#### Issue æ¨¡å¼ç‰¹ç‚¹

- âœ… **è‡ªåŠ¨åˆ†æ”¯ç®¡ç†**: æ¯æ¬¡åˆ›å»ºæ–°çš„æ—¶é—´æˆ³åˆ†æ”¯
- âœ… **æ™ºèƒ½ MR ç”Ÿæˆ**: è‡ªåŠ¨åˆ†æå˜æ›´ç±»å‹å’ŒèŒƒå›´
- âœ… **é•¿äº¤äº’æ”¯æŒ**: åŒä¸€ Issue ä¸­è¿ç»­å¯¹è¯,ä¿æŒä¸Šä¸‹æ–‡è®°å¿†
- âœ… **å®æ—¶è¿›åº¦åé¦ˆ**: åœ¨ Issue è¯„è®ºä¸­æŸ¥çœ‹å¤„ç†è¿›åº¦
- âœ… **Session ç®¡ç†**: æ™ºèƒ½çš„ä¼šè¯ç”Ÿå‘½å‘¨æœŸç®¡ç†

---

### ğŸ”€ Merge Request ä½¿ç”¨æµç¨‹

åœ¨ GitLab Merge Request ä¸­ä½¿ç”¨ AI åŠ©æ‰‹è¿›è¡Œä»£ç å®¡æŸ¥æˆ–ç›´æ¥ä¿®æ”¹ä»£ç ã€‚

#### åŸºæœ¬æµç¨‹

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant MR as GitLab MR
    participant S as Copilot æœåŠ¡
    participant A as AI æ‰§è¡Œå™¨
    participant G as Git ä»“åº“

    rect rgb(240, 248, 255)
        Note over U,MR: åœºæ™¯ 1: æ–°å»º/é‡æ–°æ‰“å¼€çš„ MR
        U->>MR: åˆ›å»º MR å¹¶ @claude
        MR->>S: è§¦å‘ Webhook
        S->>A: æ‰§è¡Œä»£ç å®¡æŸ¥
        A->>MR: å‘å¸ƒå®¡æŸ¥è¯„è®º
        MR->>U: é€šçŸ¥å®¡æŸ¥å®Œæˆ
    end

    rect rgb(255, 250, 240)
        Note over U,MR: åœºæ™¯ 2: MR è¯„è®ºä¸­çš„ä»£ç ä¿®æ”¹
        U->>MR: åœ¨è¯„è®ºä¸­ @claude ä¿®æ”¹ä»£ç 
        MR->>S: è§¦å‘ Webhook
        S->>A: æ‰§è¡Œ AI æŒ‡ä»¤
        A->>G: åˆ‡æ¢åˆ° MR æºåˆ†æ”¯
        A->>G: ç”Ÿæˆä»£ç å¹¶æäº¤
        G->>MR: è‡ªåŠ¨æ›´æ–° MR
        A->>MR: æ›´æ–°è¿›åº¦è¯„è®º
        MR->>U: é€šçŸ¥å®Œæˆ
    end
```

#### åœºæ™¯ 1: è‡ªåŠ¨ä»£ç å®¡æŸ¥

**1. åˆ›å»º MR æ—¶è§¦å‘è‡ªåŠ¨å®¡æŸ¥**

```markdown
æ ‡é¢˜: feat(api): add user profile endpoints

æè¿°:
@claude è¿™ä¸ª MR æ·»åŠ äº†ç”¨æˆ·ä¸ªäººèµ„æ–™ç®¡ç†çš„ API æ¥å£

æ–°å¢æ¥å£:
- GET /api/users/:id/profile
- PUT /api/users/:id/profile
- POST /api/users/:id/avatar
```

> ğŸ’¡ **æ™ºèƒ½é»˜è®¤è¡Œä¸º**: å¦‚æœåœ¨ MR open/reopen æ—¶æ²¡æœ‰æ˜¾å¼æåŠ `@claude` æˆ– `@codex`,ç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨ `@codex` è¿›è¡Œä»£ç å®¡æŸ¥ã€‚è¿™æ„å‘³ç€ä½ ç”šè‡³å¯ä»¥ä¸å†™ä»»ä½• AI æŒ‡ä»¤,ç³»ç»Ÿä¹Ÿä¼šè‡ªåŠ¨è§¦å‘å®¡æŸ¥!

**2. AI è‡ªåŠ¨å®¡æŸ¥**

- âœ… æ£€æµ‹åˆ°æ–° MR æˆ–é‡æ–°æ‰“å¼€çš„ MR
- âœ… å¦‚æœæœ‰æ˜¾å¼çš„ `@claude` æˆ– `@codex` æåŠ,ä½¿ç”¨æŒ‡å®šçš„ AI
- âœ… å¦‚æœæ²¡æœ‰æ˜¾å¼æåŠ,è‡ªåŠ¨ä½¿ç”¨ `@codex` è¿›è¡Œå®¡æŸ¥
- âœ… è‡ªåŠ¨è§¦å‘ä»£ç å®¡æŸ¥æµç¨‹
- âœ… AI åˆ†æä»£ç å˜æ›´
- âœ… æ ¹æ® `CODE_REVIEW_GUIDELINES.md` è¿›è¡Œå®¡æŸ¥
- âœ… å‘å¸ƒç»“æ„åŒ–çš„å®¡æŸ¥è¯„è®º

**3. AI è‡ªåŠ¨ç”Ÿæˆçš„å†…å®¹**

AI ä¼šåœ¨ MR ä¸­è‡ªåŠ¨å®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼š

##### a) è‡ªåŠ¨ä¿®å¤ MR æ ‡é¢˜

å¦‚æœ MR æ ‡é¢˜ä¸ç¬¦åˆçº¦å®šå¼æäº¤è§„èŒƒï¼ŒAI ä¼šè‡ªåŠ¨ä¿®å¤ï¼š

```
åŸæ ‡é¢˜: add user profile endpoints
â†“ AI è‡ªåŠ¨ä¿®å¤ä¸º â†“
æ–°æ ‡é¢˜: feat(api): add user profile endpoints
```

æ”¯æŒçš„ç±»å‹ï¼š`feat`, `fix`, `docs`, `style`, `refactor`, `perf`, `test`, `chore`

##### b) è‡ªåŠ¨ç”Ÿæˆ MR Summary

AI ä¼šåœ¨ MR æè¿°ä¸­è‡ªåŠ¨æ·»åŠ è¯¦ç»†çš„å˜æ›´æ¦‚è¦ï¼š

```markdown
## ğŸ“‹ MR Summary (AI ç”Ÿæˆ)

### å˜æ›´æ¦‚è¿°
æœ¬æ¬¡ MR æ–°å¢äº†ç”¨æˆ·ä¸ªäººèµ„æ–™ç®¡ç†çš„ API æ¥å£ï¼ŒåŒ…æ‹¬æŸ¥è¯¢ã€æ›´æ–°å’Œå¤´åƒä¸Šä¼ åŠŸèƒ½ã€‚

### ä¸»è¦å˜æ›´
- **æ–°å¢æ¥å£**: GET/PUT /api/users/:id/profile, POST /api/users/:id/avatar
- **æ•°æ®æ¨¡å‹**: æ‰©å±• User æ¨¡å‹ï¼Œå¢åŠ  profile ç›¸å…³å­—æ®µ
- **æƒé™æ§åˆ¶**: æ·»åŠ ç”¨æˆ·èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥
- **æ–‡ä»¶å¤„ç†**: å®ç°å¤´åƒä¸Šä¼ å’Œå­˜å‚¨é€»è¾‘

### å½±å“åˆ†æ
- âœ… **å‘åå…¼å®¹**: ä¸å½±å“ç°æœ‰ API
- âš ï¸ **æ•°æ®åº“å˜æ›´**: éœ€è¦æ‰§è¡Œ migration è„šæœ¬
- âœ… **æµ‹è¯•è¦†ç›–**: å·²æ·»åŠ å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

### æµ‹è¯•å»ºè®®
- [ ] æµ‹è¯•æ­£å¸¸çš„ç”¨æˆ·èµ„æ–™æŸ¥è¯¢å’Œæ›´æ–°
- [ ] æµ‹è¯•æƒé™æ§åˆ¶ï¼ˆç¦æ­¢ä¿®æ”¹ä»–äººèµ„æ–™ï¼‰
- [ ] æµ‹è¯•æ–‡ä»¶ä¸Šä¼ é™åˆ¶ï¼ˆå¤§å°ã€æ ¼å¼ï¼‰
- [ ] æµ‹è¯•å¼‚å¸¸æƒ…å†µå¤„ç†

### éƒ¨ç½²æ³¨æ„äº‹é¡¹
1. éƒ¨ç½²å‰æ‰§è¡Œæ•°æ®åº“ migration
2. é…ç½®æ–‡ä»¶å­˜å‚¨è·¯å¾„ï¼ˆç¯å¢ƒå˜é‡ UPLOAD_PATHï¼‰
3. è®¾ç½®æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶
```

##### c) ç»“æ„åŒ–ä»£ç å®¡æŸ¥

```markdown
## ğŸ¤– AI ä»£ç å®¡æŸ¥æŠ¥å‘Š

### æ€»ä½“è¯„ä»·
âœ… ä»£ç è´¨é‡è‰¯å¥½,ç¬¦åˆé¡¹ç›®è§„èŒƒ

### è¯¦ç»†åé¦ˆ

**æ–‡ä»¶:** src/api/userController.ts
**è¡Œå·:** 45-52
**è¯„è®º:** å»ºè®®æ·»åŠ è¾“å…¥éªŒè¯,é˜²æ­¢ SQL æ³¨å…¥æ”»å‡»
**ä¸¥é‡æ€§:** warning
**ç±»åˆ«:** security

**å»ºè®®ä»£ç :**
\```typescript
if (!validator.isUUID(userId)) {
  return res.status(400).json({ error: 'Invalid user ID' });
}
\```

---

**æ–‡ä»¶:** src/api/userController.ts
**è¡Œå·:** 78
**è¯„è®º:** å»ºè®®æ·»åŠ é”™è¯¯å¤„ç†,é¿å…æœªæ•è·çš„å¼‚å¸¸
**ä¸¥é‡æ€§:** error
**ç±»åˆ«:** logic

**å»ºè®®ä»£ç :**
\```typescript
try {
  const profile = await userService.getProfile(userId);
  return res.json(profile);
} catch (error) {
  logger.error('Failed to get profile', error);
  return res.status(500).json({ error: 'Internal server error' });
}
\```

---

**æ–‡ä»¶:** src/api/userController.ts
**è¡Œå·:** 120-130
**è¯„è®º:** æ€§èƒ½ä¼˜åŒ–å»ºè®®: è€ƒè™‘æ·»åŠ ç¼“å­˜å±‚
**ä¸¥é‡æ€§:** info
**ç±»åˆ«:** performance

---

### æµ‹è¯•å»ºè®®

- [ ] æ·»åŠ è¾“å…¥éªŒè¯æµ‹è¯•ç”¨ä¾‹
- [ ] æ·»åŠ é”™è¯¯å¤„ç†æµ‹è¯•
- [ ] æ·»åŠ æ€§èƒ½æµ‹è¯•
- [ ] æµ‹è¯•è¾¹ç•Œæ¡ä»¶

### å®‰å…¨æ£€æŸ¥æ¸…å•

- âš ï¸ è¾“å…¥éªŒè¯ä¸å®Œæ•´
- âœ… è®¤è¯ä¸­é—´ä»¶æ­£ç¡®ä½¿ç”¨
- âœ… æ•æ„Ÿæ•°æ®æ­£ç¡®å¤„ç†
- âš ï¸ é”™è¯¯ä¿¡æ¯å¯èƒ½æ³„éœ²ç»†èŠ‚

ğŸ¤– ç”± GitLab AI Copilot è‡ªåŠ¨å®¡æŸ¥
```

#### åœºæ™¯ 2: MR è¯„è®ºä¸­ç›´æ¥ä¿®æ”¹ä»£ç 

**1. åœ¨ MR è¯„è®ºä¸­è¯·æ±‚ä»£ç ä¿®æ”¹**

```markdown
@claude è¯·æ ¹æ®å®¡æŸ¥æ„è§ä¿®å¤æ‰€æœ‰å®‰å…¨é—®é¢˜å’Œé”™è¯¯å¤„ç†

å¦å¤–,è¯·æ·»åŠ ä»¥ä¸‹åŠŸèƒ½:
- æ·»åŠ ç”¨æˆ·å¤´åƒä¸Šä¼ å¤§å°é™åˆ¶ (æœ€å¤§ 5MB)
- æ·»åŠ å›¾ç‰‡æ ¼å¼éªŒè¯ (åªå…è®¸ jpg, png)
- ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½
```

**2. AI å¤„ç†æµç¨‹**

- âœ… æ£€æµ‹åˆ° MR è¯„è®ºä¸­çš„ `@claude` æŒ‡ä»¤
- âœ… è¯†åˆ«è¿™æ˜¯åœ¨ MR ä¸Šä¸‹æ–‡ä¸­çš„è¯·æ±‚
- âœ… å…‹éš†ä»“åº“å¹¶åˆ‡æ¢åˆ° **MR çš„æºåˆ†æ”¯**
- âœ… æ‰§è¡Œä»£ç ä¿®æ”¹
- âœ… æäº¤æ›´æ”¹åˆ°æºåˆ†æ”¯
- âœ… æ¨é€åˆ°è¿œç¨‹ä»“åº“
- âœ… **MR è‡ªåŠ¨æ›´æ–°** (æ— éœ€åˆ›å»ºæ–°åˆ†æ”¯æˆ–æ–° MR)
- âœ… åœ¨è¯„è®ºä¸­æ›´æ–°å¤„ç†è¿›åº¦

**3. è¿›åº¦æ›´æ–°è¯„è®º**

```markdown
ğŸ¤– AI å¤„ç†è¿›åº¦:

âœ… åˆ‡æ¢åˆ° MR æºåˆ†æ”¯: feature/user-profile-api
âœ… å…‹éš†ä»“åº“å®Œæˆ
â³ æ­£åœ¨ä¿®æ”¹ä»£ç ...
âœ… ä»£ç ä¿®æ”¹å®Œæˆ
âœ… æäº¤æ›´æ”¹: "fix(api): add input validation and error handling"
âœ… æ¨é€åˆ°è¿œç¨‹ä»“åº“
âœ… MR å·²è‡ªåŠ¨æ›´æ–°

ğŸ‰ å¤„ç†å®Œæˆï¼ä»£ç å·²æ›´æ–°åˆ°å½“å‰ MR

å˜æ›´å†…å®¹:
- âœ… æ·»åŠ è¾“å…¥éªŒè¯
- âœ… å®Œå–„é”™è¯¯å¤„ç†
- âœ… æ·»åŠ å¤´åƒä¸Šä¼ é™åˆ¶
- âœ… æ·»åŠ å›¾ç‰‡æ ¼å¼éªŒè¯
- âœ… ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢

è¯·é‡æ–°æŸ¥çœ‹ä»£ç å˜æ›´ã€‚
```

#### MR æ¨¡å¼ç‰¹ç‚¹

**è‡ªåŠ¨ä»£ç å®¡æŸ¥ (æ–°å»º/é‡æ–°æ‰“å¼€çš„ MR)**
- âœ… **æ™ºèƒ½é»˜è®¤**: æ–°å»ºæˆ–é‡æ–°æ‰“å¼€ MR æ—¶,å³ä½¿æ²¡æœ‰ä»»ä½• AI æåŠ,ä¹Ÿä¼šè‡ªåŠ¨ä½¿ç”¨ `@codex` è¿›è¡Œå®¡æŸ¥
- âœ… **çµæ´»é€‰æ‹©**: å¯ä»¥é€šè¿‡æ˜¾å¼æåŠ `@claude` æˆ– `@codex` æ¥æŒ‡å®šä½¿ç”¨å“ªä¸ª AI
- âœ… **éµå¾ªè§„èŒƒ**: æ ¹æ® `CODE_REVIEW_GUIDELINES.md` è¿›è¡Œå®¡æŸ¥
- âœ… **ç»“æ„åŒ–åé¦ˆ**: æŒ‰æ–‡ä»¶ã€è¡Œå·ã€ä¸¥é‡æ€§åˆ†ç±»
- âœ… **å¯æ“ä½œå»ºè®®**: æä¾›å…·ä½“çš„ä»£ç æ”¹è¿›å»ºè®®
- âœ… **è‡ªåŠ¨ Summary**: AI è‡ªåŠ¨ç”Ÿæˆç»“æ„åŒ–çš„å˜æ›´æ¦‚è¦,åŒ…æ‹¬å½±å“åˆ†æå’Œæµ‹è¯•å»ºè®®
- âœ… **æ ‡é¢˜è§„èŒƒåŒ–**: è‡ªåŠ¨æ£€æµ‹å¹¶ä¿®å¤ä¸ç¬¦åˆçº¦å®šå¼æäº¤è§„èŒƒçš„ MR æ ‡é¢˜

**MR è¯„è®ºä»£ç ä¿®æ”¹**
- âœ… **ç›´æ¥æ›´æ–°**: ä¿®æ”¹ç›´æ¥æäº¤åˆ° MR æºåˆ†æ”¯
- âœ… **æ— éœ€æ–°åˆ†æ”¯**: ä¸åˆ›å»ºæ–°çš„åˆ†æ”¯æˆ– MR
- âœ… **è‡ªåŠ¨æ›´æ–°**: MR å†…å®¹è‡ªåŠ¨åˆ·æ–°
- âœ… **å®æ—¶åé¦ˆ**: è¯„è®ºä¸­æ˜¾ç¤ºå¤„ç†è¿›åº¦
- âœ… **è‡ªåŠ¨åŒæ­¥è¿œç«¯**: è‹¥æ¨é€è¢«æ‹’ç»ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œ `git pull --rebase` åŒæ­¥æœ€æ–°æäº¤
- âœ… **å†²çªè‡ªæ„ˆå°è¯•**: rebase å‡ºç°å†²çªæ—¶ï¼ŒAI ä¼šå°è¯•è‡ªåŠ¨ä¿®å¤å†²çªå¹¶å®Œæˆæ¨é€ï¼›è‹¥ä»å¤±è´¥ï¼Œä¼šåˆ—å‡ºéœ€è¦äººå·¥å¤„ç†çš„æ–‡ä»¶

**é‡è¦è¯´æ˜**
- âš ï¸ **æ›´æ–°çš„ MR**: æ‰€æœ‰ `@claude`/`@codex` æåŠéƒ½ä¼šè¢«å¿½ç•¥ (é˜²æ­¢é‡å¤å¤„ç†)
- â„¹ï¸ **å®¡æŸ¥ vs ä¿®æ”¹**:
  - MR æè¿°ä¸­çš„ `@claude` = ä»£ç å®¡æŸ¥
  - MR è¯„è®ºä¸­çš„ `@claude` = ä»£ç ä¿®æ”¹

---

### ğŸ’¡ æœ€ä½³å®è·µ

#### Issue å¼€å‘å»ºè®®

1. **æ¸…æ™°çš„éœ€æ±‚æè¿°**: åœ¨ `@claude` æŒ‡ä»¤åè¯¦ç»†æè¿°éœ€æ±‚
2. **åˆ©ç”¨é•¿äº¤äº’**: åœ¨åŒä¸€ Issue ä¸­é€æ­¥å®Œå–„åŠŸèƒ½
3. **åŠæ—¶åé¦ˆ**: æŸ¥çœ‹ç”Ÿæˆçš„ MR,æä¾›åé¦ˆæ„è§
4. **åˆç†æ‹†åˆ†**: å¤æ‚åŠŸèƒ½æ‹†åˆ†ä¸ºå¤šä¸ª Issue

#### MR å®¡æŸ¥å»ºè®®

1. **åŠæ—©å®¡æŸ¥**: åˆ›å»º MR æ—¶å°±è¯·æ±‚ AI å®¡æŸ¥
2. **æŒç»­æ”¹è¿›**: åœ¨è¯„è®ºä¸­è¯·æ±‚ä¿®å¤å®¡æŸ¥å‘ç°çš„é—®é¢˜
3. **éµå¾ªæŒ‡å—**: ç¡®ä¿é¡¹ç›®æœ‰ `CODE_REVIEW_GUIDELINES.md`
4. **äººå·¥å¤æ ¸**: AI å®¡æŸ¥åä»éœ€äººå·¥æœ€ç»ˆç¡®è®¤

#### é€šç”¨å»ºè®®

1. **æ˜ç¡®æŒ‡ä»¤**: ä½¿ç”¨æ¸…æ™°ã€å…·ä½“çš„æŒ‡ä»¤æè¿°éœ€æ±‚
2. **ä¸Šä¸‹æ–‡ä¿¡æ¯**: æä¾›è¶³å¤Ÿçš„èƒŒæ™¯ä¿¡æ¯å’Œçº¦æŸæ¡ä»¶
3. **å¢é‡å¼€å‘**: é‡‡ç”¨å°æ­¥å¿«è·‘çš„å¼€å‘æ–¹å¼
4. **ä»£ç å®¡æŸ¥**: AI ç”Ÿæˆçš„ä»£ç ä»éœ€äººå·¥å®¡æŸ¥

## ğŸ–¥ï¸ Web ç®¡ç†ç•Œé¢

### å¯ç”¨ Web UI

1. **é…ç½®ç¯å¢ƒå˜é‡**
   ```bash
   WEB_UI_ENABLED=true
   WEB_UI_BASE_PATH=/auth
   JWT_SECRET=your_jwt_secret_here
   ```

2. **è®¿é—®ç•Œé¢**
   ```
   http://localhost:3000/auth/
   ```

### åŠŸèƒ½ç‰¹æ€§

- **ç”¨æˆ·æ³¨å†Œ/ç™»å½•**: å®‰å…¨çš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- **GitLab é…ç½®ç®¡ç†**: å¯è§†åŒ–é…ç½® GitLab è¿æ¥
- **ä¼šè¯ç›‘æ§**: å®æ—¶æŸ¥çœ‹æ´»è·ƒçš„ AI ä¼šè¯
- **ä½¿ç”¨ç»Ÿè®¡**: æŸ¥çœ‹ AI ä½¿ç”¨æƒ…å†µå’Œç»Ÿè®¡æ•°æ®
- **å®‰å…¨è®¾ç½®**: ç®¡ç†è®¿é—®ä»¤ç‰Œå’Œæƒé™

### ç§Ÿæˆ·ç®¡ç†

ä½¿ç”¨ CLI å·¥å…·å¿«é€Ÿè®¾ç½®ç§Ÿæˆ·ï¼š

```bash
# åˆ›å»ºæ–°ç§Ÿæˆ·
npm run setup-user -- \
  --email user@example.com \
  --name "Demo User" \
  --gitlab-url https://gitlab.com \
  --pat your_gitlab_token

# æ›´æ–°ç°æœ‰ç§Ÿæˆ·
npm run setup-user -- \
  --user-token existing_token \
  --pat new_gitlab_token
```

## ğŸ“š API æ–‡æ¡£

### Webhook ç«¯ç‚¹

#### POST `/webhook/:userToken?`

æ¥æ”¶ GitLab webhook äº‹ä»¶

**å‚æ•°:**
- `userToken` (å¯é€‰): å¤šç§Ÿæˆ·æ¨¡å¼ä¸‹çš„ç”¨æˆ·ä»¤ç‰Œ

**è¯·æ±‚å¤´:**
- `X-Gitlab-Token`: Webhook éªŒè¯ä»¤ç‰Œ
- `X-Gitlab-Event`: äº‹ä»¶ç±»å‹

**å“åº”:**
```json
{
  "status": "success",
  "message": "Event processed successfully",
  "sessionId": "session_123" // å¦‚æœæ˜¯ Session æ¨¡å¼
}
```

### å¥åº·æ£€æŸ¥ç«¯ç‚¹

#### GET `/health`

è·å–æœåŠ¡å¥åº·çŠ¶æ€

**å“åº”:**
```json
{
  "status": "healthy",
  "timestamp": "2024-01-15T10:30:00.000Z",
  "uptime": 3600,
  "memory": {
    "rss": 67108864,
    "heapTotal": 45088768,
    "heapUsed": 32505856
  },
  "version": "1.0.0",
  "environment": "production",
  "sessions": {
    "enabled": true,
    "cleanupService": {
      "isRunning": true,
      "cleanupInterval": 3600000,
      "maxIdleTime": 604800000,
      "nextCleanup": "2024-01-15T11:30:00.000Z"
    },
    "stats": {
      "totalSessions": 25,
      "activeSessions": 20,
      "expiredSessions": 5
    }
  }
}
```

### Web UI API ç«¯ç‚¹

#### POST `/auth/register`
ç”¨æˆ·æ³¨å†Œ

#### POST `/auth/login`
ç”¨æˆ·ç™»å½•

#### GET `/auth/dashboard`
è·å–ä»ªè¡¨ç›˜æ•°æ®

#### GET `/auth/gitlab-config`
è·å– GitLab é…ç½®

#### POST `/auth/gitlab-config`
ä¿å­˜ GitLab é…ç½®

## ğŸ“Š ç›‘æ§å’Œç®¡ç†

### å¥åº·æ£€æŸ¥

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:3000/health

# æ£€æŸ¥ç‰¹å®šç»„ä»¶
curl http://localhost:3000/health | jq '.sessions'
```

### æ—¥å¿—ç›‘æ§

```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker-compose logs -f gitlab-copilot

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
docker-compose logs gitlab-copilot | grep ERROR

# è®¾ç½®è°ƒè¯•çº§åˆ«
LOG_LEVEL=debug npm run dev
```

### æ€§èƒ½ç›‘æ§

- **å†…å­˜ä½¿ç”¨**: é€šè¿‡å¥åº·æ£€æŸ¥ç«¯ç‚¹ç›‘æ§
- **Session ç»Ÿè®¡**: æ´»è·ƒä¼šè¯æ•°é‡å’ŒçŠ¶æ€
- **å“åº”æ—¶é—´**: GitLab API è°ƒç”¨å»¶è¿Ÿ
- **é”™è¯¯ç‡**: AI æ‰§è¡Œå¤±è´¥ç‡

### å‘Šè­¦é…ç½®

æ¨èç›‘æ§æŒ‡æ ‡ï¼š

- æœåŠ¡å¯ç”¨æ€§ (HTTP 200 å“åº”)
- å†…å­˜ä½¿ç”¨ç‡ (< 80%)
- Session æ•°é‡ (< é…ç½®çš„æœ€å¤§å€¼)
- é”™è¯¯æ—¥å¿—é¢‘ç‡
- AI æ‰§è¡ŒæˆåŠŸç‡

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

<details>
<summary><strong>AI æ‰§è¡Œå¤±è´¥</strong></summary>

**ç—‡çŠ¶**: AI æŒ‡ä»¤æ— å“åº”æˆ–è¿”å›é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ AI CLI å·¥å…·æ˜¯å¦æ­£ç¡®å®‰è£…
   ```bash
   claude --version
   ```
2. éªŒè¯ API ä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆ
   ```bash
   claude auth status
   ```
3. æ£€æŸ¥æœåŠ¡æ—¥å¿—
   ```bash
   docker-compose logs gitlab-copilot | grep ERROR
   ```
4. é‡æ–°ç™»å½• AI æœåŠ¡
   ```bash
   claude login
   ```

</details>

<details>
<summary><strong>Webhook éªŒè¯å¤±è´¥</strong></summary>

**ç—‡çŠ¶**: GitLab webhook è¿”å› 401 æˆ– 403 é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. éªŒè¯ webhook secret é…ç½®
2. æ£€æŸ¥ GitLab webhook é…ç½®ä¸­çš„ Secret Token
3. ç¡®ä¿ URL æ­£ç¡® (å¤šç§Ÿæˆ·æ¨¡å¼éœ€è¦åŒ…å« userToken)
4. æ£€æŸ¥é˜²ç«å¢™å’Œç½‘ç»œé…ç½®

</details>

<details>
<summary><strong>Session ç›¸å…³é—®é¢˜</strong></summary>

**ç—‡çŠ¶**: é•¿äº¤äº’æ¨¡å¼ä¸å·¥ä½œæˆ–ä¼šè¯ä¸¢å¤±

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ Session é…ç½®
   ```bash
   curl http://localhost:3000/health | jq '.sessions'
   ```
2. éªŒè¯ Session å­˜å‚¨è·¯å¾„æƒé™
3. æ£€æŸ¥ Session è¿‡æœŸæ—¶é—´é…ç½®
4. é‡å¯ Session æ¸…ç†æœåŠ¡

</details>

<details>
<summary><strong>æ•°æ®åº“è¿æ¥é—®é¢˜</strong></summary>

**ç—‡çŠ¶**: å¤šç§Ÿæˆ·æ¨¡å¼æ— æ³•å¯åŠ¨æˆ–æ•°æ®ä¿å­˜å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
1. éªŒè¯ MongoDB è¿æ¥å­—ç¬¦ä¸²
2. æ£€æŸ¥æ•°æ®åº“æƒé™
3. ç¡®è®¤ç½‘ç»œè¿é€šæ€§
4. æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—

</details>

### è°ƒè¯•æŠ€å·§

1. **å¯ç”¨è°ƒè¯•æ—¥å¿—**
   ```bash
   LOG_LEVEL=debug npm run dev
   ```

2. **æ£€æŸ¥ç¯å¢ƒå˜é‡**
   ```bash
   npm run config:debug
   ```

3. **æµ‹è¯• GitLab è¿æ¥**
   ```bash
   curl -H "Authorization: Bearer $GITLAB_TOKEN" \
        "$GITLAB_BASE_URL/api/v4/user"
   ```

4. **éªŒè¯ AI CLI å·¥å…·**
   ```bash
   claude --help
   echo "test" | claude
   ```

### æ€§èƒ½ä¼˜åŒ–

- **è°ƒæ•´ Session é…ç½®**: æ ¹æ®ä½¿ç”¨é‡è°ƒæ•´æœ€å¤§ä¼šè¯æ•°å’Œæ¸…ç†é—´éš”
- **ä¼˜åŒ–å·¥ä½œç›®å½•**: ä½¿ç”¨ SSD å­˜å‚¨æé«˜ Git æ“ä½œæ€§èƒ½
- **é…ç½®ç¼“å­˜**: å¯ç”¨ GitLab API å“åº”ç¼“å­˜
- **è´Ÿè½½å‡è¡¡**: åœ¨é«˜è´Ÿè½½ç¯å¢ƒä¸‹ä½¿ç”¨å¤šå®ä¾‹éƒ¨ç½²

## ğŸ‘¨â€ğŸ’» å¼€å‘æŒ‡å—

### å¼€å‘ç¯å¢ƒè®¾ç½®

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone <repository-url>
   cd gitlab-copilot
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   npm install
   ```

3. **è®¾ç½®å¼€å‘ç¯å¢ƒ**
   ```bash
   cp .env.example .env.development
   # ç¼–è¾‘å¼€å‘ç¯å¢ƒé…ç½®
   ```

4. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
   ```bash
   npm run dev
   ```

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ server/           # æœåŠ¡å™¨ç›¸å…³
â”‚   â”œâ”€â”€ webhookServer.ts
â”‚   â””â”€â”€ __tests__/
â”œâ”€â”€ services/         # ä¸šåŠ¡é€»è¾‘æœåŠ¡
â”‚   â”œâ”€â”€ eventProcessor.ts
â”‚   â”œâ”€â”€ sessionManager.ts
â”‚   â”œâ”€â”€ aiExecutor.ts
â”‚   â””â”€â”€ storage/      # æ•°æ®å­˜å‚¨
â”œâ”€â”€ routes/           # API è·¯ç”±
â”œâ”€â”€ middleware/       # ä¸­é—´ä»¶
â”œâ”€â”€ utils/            # å·¥å…·å‡½æ•°
â”œâ”€â”€ types/            # TypeScript ç±»å‹å®šä¹‰
â””â”€â”€ __tests__/        # æµ‹è¯•æ–‡ä»¶
```

### å¼€å‘å‘½ä»¤

```bash
# å¼€å‘æ¨¡å¼ (çƒ­é‡è½½)
npm run dev

# æ„å»ºé¡¹ç›®
npm run build

# ä»£ç æ£€æŸ¥
npm run lint
npm run lint:fix

# æ ¼å¼åŒ–ä»£ç 
npm run format

# è¿è¡Œæµ‹è¯•
npm test
npm run test:watch
npm run test:coverage

# ç±»å‹æ£€æŸ¥
npm run type-check

# ç”Ÿäº§ç¯å¢ƒå¯åŠ¨
npm start
```

### æµ‹è¯•

é¡¹ç›®åŒ…å«å®Œæ•´çš„æµ‹è¯•å¥—ä»¶ï¼š

- **å•å…ƒæµ‹è¯•**: 55+ æµ‹è¯•ç”¨ä¾‹
- **é›†æˆæµ‹è¯•**: API ç«¯ç‚¹æµ‹è¯•
- **E2E æµ‹è¯•**: å®Œæ•´å·¥ä½œæµæµ‹è¯•
- **æ€§èƒ½æµ‹è¯•**: è´Ÿè½½å’Œå‹åŠ›æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
npm test -- sessionManager.test.ts

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage
```

### ä»£ç è§„èŒƒ

é¡¹ç›®ä½¿ç”¨ä»¥ä¸‹å·¥å…·ç¡®ä¿ä»£ç è´¨é‡ï¼š

- **ESLint**: ä»£ç æ£€æŸ¥
- **Prettier**: ä»£ç æ ¼å¼åŒ–
- **TypeScript**: ç±»å‹å®‰å…¨
- **Husky**: Git hooks
- **lint-staged**: æäº¤å‰æ£€æŸ¥

### è´¡çŒ®æµç¨‹

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»º Pull Request

## ğŸ“ˆ æ›´æ–°æ—¥å¿—

### v2.1.0 - Web UI å¢å¼º (è®¡åˆ’ä¸­)
- ğŸ”„ å¢å¼ºçš„ Web ç®¡ç†ç•Œé¢
- ğŸ“Š è¯¦ç»†çš„ä½¿ç”¨ç»Ÿè®¡å’Œåˆ†æ
- ğŸ” æ”¹è¿›çš„å®‰å…¨æ€§å’Œæƒé™ç®¡ç†
- ğŸŒ å›½é™…åŒ–æ”¯æŒ

### v2.0.0 - é•¿äº¤äº’æ¨¡å¼
- âœ… æ–°å¢é•¿äº¤äº’ Session ç®¡ç†ç³»ç»Ÿ
- âœ… æ”¯æŒåœ¨ Issue ä¸­è¿›è¡Œè¿ç»­ AI å¯¹è¯
- âœ… æ™ºèƒ½ Session ç”Ÿå‘½å‘¨æœŸç®¡ç†
- âœ… è‡ªåŠ¨ Session æ¸…ç†å’Œèµ„æºä¼˜åŒ–
- âœ… å¥åº·æ£€æŸ¥ç«¯ç‚¹å¢åŠ  Session ç›‘æ§
- âœ… å…¨é¢çš„é…ç½®ç³»ç»Ÿæ‰©å±•
- âœ… å®Œæ•´çš„æµ‹è¯•è¦†ç›–ï¼ˆ55ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰

### v1.0.0 - åŸºç¡€åŠŸèƒ½
- âœ… AI Webhook é›†æˆï¼ˆClaudeã€Codexï¼‰
- âœ… è‡ªåŠ¨åˆ†æ”¯å’Œ MR åˆ›å»º
- âœ… ä»£ç å®¡æŸ¥åŠŸèƒ½
- âœ… æ™ºèƒ½ MR ç”Ÿæˆ
- âœ… Docker éƒ¨ç½²æ”¯æŒ

<details>
<summary>æŸ¥çœ‹å®Œæ•´æ›´æ–°å†å²</summary>

#### v1.2.0
- æ·»åŠ å¤šç§Ÿæˆ·æ”¯æŒ
- Web UI åŸºç¡€åŠŸèƒ½
- å®‰å…¨æ€§å¢å¼º

#### v1.1.0
- æ€§èƒ½ä¼˜åŒ–
- é”™è¯¯å¤„ç†æ”¹è¿›
- æ—¥å¿—ç³»ç»Ÿå¢å¼º

</details>

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿æ‰€æœ‰å½¢å¼çš„è´¡çŒ®ï¼

### å¦‚ä½•è´¡çŒ®

1. **æŠ¥å‘Š Bug**: ä½¿ç”¨ [Issue æ¨¡æ¿](https://github.com/your-repo/issues/new?template=bug_report.md)
2. **åŠŸèƒ½è¯·æ±‚**: ä½¿ç”¨ [åŠŸèƒ½è¯·æ±‚æ¨¡æ¿](https://github.com/your-repo/issues/new?template=feature_request.md)
3. **ä»£ç è´¡çŒ®**: æäº¤ Pull Request

### å¼€å‘æŒ‡å—

- éµå¾ªç°æœ‰çš„ä»£ç é£æ ¼
- æ·»åŠ é€‚å½“çš„æµ‹è¯•
- æ›´æ–°ç›¸å…³æ–‡æ¡£
- ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡

### è¡Œä¸ºå‡†åˆ™

è¯·é˜…è¯»æˆ‘ä»¬çš„ [è¡Œä¸ºå‡†åˆ™](CODE_OF_CONDUCT.md) ä»¥äº†è§£ç¤¾åŒºæ ‡å‡†ã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£æ›´å¤šè¯¦æƒ…ã€‚

---

<div align="center">

**[â¬† å›åˆ°é¡¶éƒ¨](#gitlab-ai-copilot-)**

Made with â¤ï¸ by the GitLab AI Copilot Team

</div>
# gitlab-copilot
